<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì›¹í›… ë””ë²„ê·¸ (ë‹¨ìˆœ)</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      padding: 20px;
      background: #1e1e1e;
      color: #d4d4d4;
    }

    .log {
      background: #252526;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
      border-left: 3px solid #007acc;
    }

    .error {
      border-left-color: #f44747;
    }

    .success {
      border-left-color: #4ec9b0;
    }

    button {
      background: #007acc;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }

    button:hover {
      background: #005a9e;
    }

    pre {
      white-space: pre-wrap;
      word-wrap: break-word;
    }
  </style>
</head>

<body>
  <h1>ğŸ” ì›¹í›… ë‹¨ìˆœ ë””ë²„ê·¸</h1>
  <button onclick="testStep1()">1ë‹¨ê³„: IP í™•ì¸</button>
  <button onclick="testStep2()">2ë‹¨ê³„: ipapi.co í…ŒìŠ¤íŠ¸</button>
  <button onclick="testStep3()">3ë‹¨ê³„: ì›¹í›… ì „ì†¡ í…ŒìŠ¤íŠ¸</button>
  <button onclick="testFullFlow()">ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸</button>
  <button onclick="clearLogs()">ë¡œê·¸ ì§€ìš°ê¸°</button>

  <div id="logs"></div>

  <script>
    const WEBHOOK_URL = 'https://discord.com/api/webhooks/1448558533397446696/eaX0Rdzr5DgzdXVB1UfVzp4dEtXT12r9mDtIY9a8my40nZhvR5xQiwweuLV43o4QRYHn';
    const WEBHOOK_URL_2 = 'https://discord.com/api/webhooks/1448713634111815691/aUP_IgLHFpoYGYvUZmxauDVGCWdj-7ZW7lDfhLgXkP9UeOFrR_N_3pramrO7jHHbaKsT';

    function log(message, type = 'log') {
      const div = document.createElement('div');
      div.className = `log ${type}`;
      div.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
      document.getElementById('logs').appendChild(div);
      console.log(message);
    }

    function clearLogs() {
      document.getElementById('logs').innerHTML = '';
    }

    async function testStep1() {
      log('ğŸ” 1ë‹¨ê³„: IP í™•ì¸ ì‹œì‘...', 'log');
      try {
        const response = await fetch('https://api64.ipify.org?format=json');
        const data = await response.json();
        log(`âœ… IPv4: ${data.ip}`, 'success');

        const response6 = await fetch('https://api6.ipify.org?format=json');
        const data6 = await response6.json();
        log(`âœ… IPv6: ${data6.ip}`, 'success');
      } catch (error) {
        log(`âŒ IP í™•ì¸ ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    }

    async function testStep2() {
      log('ğŸŒ 2ë‹¨ê³„: ipapi.co API í…ŒìŠ¤íŠ¸...', 'log');
      try {
        const response = await fetch('https://api64.ipify.org?format=json');
        const data = await response.json();
        const ip = data.ip;
        log(`IP: ${ip}`, 'log');

        log('ipapi.co í˜¸ì¶œ ì¤‘...', 'log');
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 5000);

        const ipApiResponse = await fetch(`https://ipapi.co/${ip}/json/`, {
          signal: controller.signal
        });
        clearTimeout(timeoutId);

        const ipApiData = await ipApiResponse.json();
        log(`âœ… ipapi.co ì‘ë‹µ: <pre>${JSON.stringify(ipApiData, null, 2)}</pre>`, 'success');
      } catch (error) {
        log(`âŒ ipapi.co ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    }

    async function testStep3() {
      log('ğŸ“¡ 3ë‹¨ê³„: ì›¹í›… ì „ì†¡ í…ŒìŠ¤íŠ¸...', 'log');

      const testPayload = {
        content: 'ğŸ§ª **í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€** - ì›¹í›… ì—°ê²° í™•ì¸',
        embeds: [{
          title: 'âœ… ì›¹í›… í…ŒìŠ¤íŠ¸',
          description: 'ì´ ë©”ì‹œì§€ê°€ ë³´ì´ë©´ ì›¹í›…ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.',
          color: 0x00FF00,
          timestamp: new Date().toISOString(),
          fields: [
            { name: 'í…ŒìŠ¤íŠ¸ ì‹œê°„', value: new Date().toLocaleString('ko-KR'), inline: false },
            { name: 'í˜ì´ì§€', value: window.location.href, inline: false }
          ]
        }]
      };

      try {
        log('ì›¹í›… 1 ì „ì†¡ ì¤‘...', 'log');
        const response1 = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(testPayload)
        });

        if (response1.ok) {
          log('âœ… ì›¹í›… 1 ì „ì†¡ ì„±ê³µ!', 'success');
        } else {
          log(`âŒ ì›¹í›… 1 ì‹¤íŒ¨: ${response1.status} ${response1.statusText}`, 'error');
        }

        log('ì›¹í›… 2 ì „ì†¡ ì¤‘...', 'log');
        const response2 = await fetch(WEBHOOK_URL_2, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(testPayload)
        });

        if (response2.ok) {
          log('âœ… ì›¹í›… 2 ì „ì†¡ ì„±ê³µ!', 'success');
        } else {
          log(`âŒ ì›¹í›… 2 ì‹¤íŒ¨: ${response2.status} ${response2.statusText}`, 'error');
        }
      } catch (error) {
        log(`âŒ ì›¹í›… ì „ì†¡ ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    }

    async function testFullFlow() {
      log('ğŸš€ ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹œì‘...', 'log');
      await testStep1();
      await new Promise(resolve => setTimeout(resolve, 1000));
      await testStep2();
      await new Promise(resolve => setTimeout(resolve, 1000));
      await testStep3();
      log('âœ… ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ localStorage í™•ì¸
    window.addEventListener('load', () => {
      log('ğŸ“Š í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'log');

      // localStorageì— ìˆëŠ” ëª¨ë“  debug_ í‚¤ í™•ì¸
      const debugKeys = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.startsWith('debug_')) {
          debugKeys.push(`${key}: ${localStorage.getItem(key)}`);
        }
      }

      if (debugKeys.length > 0) {
        log(`ğŸ” localStorage ë””ë²„ê·¸ í‚¤:<br><pre>${debugKeys.join('\n')}</pre>`, 'log');
      } else {
        log('âš ï¸ localStorageì— ë””ë²„ê·¸ í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.', 'log');
      }
    });
  </script>
</body>

</html>